{"version":3,"file":"delay-response.js","sourceRoot":"","sources":["../src/in-mem/delay-response.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,MAAM,CAAC;AAElC,0CAA0C;AAC1C,8FAA8F;AAC9F,MAAM,UAAU,aAAa,CAAI,SAAwB,EAAE,OAAe;IACxE,OAAO,IAAI,UAAU,CAAI,QAAQ,CAAC,EAAE;QAClC,IAAI,eAAe,GAAG,KAAK,CAAC;QAC5B,IAAI,WAAW,GAAG,KAAK,CAAC;QACxB,MAAM,YAAY,GAAG,SAAS,CAAC,SAAS,CACtC,KAAK,CAAC,EAAE;YACJ,WAAW,GAAG,IAAI,CAAC;YACnB,UAAU,CAAC,GAAG,EAAE;gBAChB,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACrB,IAAI,eAAe,EAAE;oBACnB,QAAQ,CAAC,QAAQ,EAAE,CAAC;iBACrB;YACH,CAAC,EAAE,OAAO,CAAC,CAAC;QACd,CAAC,EACD,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,EACzD,GAAG,EAAE;YACH,eAAe,GAAG,IAAI,CAAC;YACvB,IAAI,CAAC,WAAW,EAAE;gBAChB,QAAQ,CAAC,QAAQ,EAAE,CAAC;aACrB;QACH,CAAC,CACF,CAAC;QACF,OAAO,GAAG,EAAE;YACV,OAAO,YAAY,CAAC,WAAW,EAAE,CAAC;QACpC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { Observable } from 'rxjs';\n\n// Replaces use of RxJS delay. See v0.5.4.\n/** adds specified delay (in ms) to both next and error channels of the response observable */\nexport function delayResponse<T>(response$: Observable<T>, delayMs: number): Observable<T> {\n  return new Observable<T>(observer => {\n    let completePending = false;\n    let nextPending = false;\n    const subscription = response$.subscribe(\n      value => {\n          nextPending = true;\n          setTimeout(() => {\n          observer.next(value);\n          if (completePending) {\n            observer.complete();\n          }\n        }, delayMs);\n      },\n      error => setTimeout(() => observer.error(error), delayMs),\n      () => {\n        completePending = true;\n        if (!nextPending) {\n          observer.complete();\n        }\n      }\n    );\n    return () => {\n      return subscription.unsubscribe();\n    };\n  });\n}\n"]}